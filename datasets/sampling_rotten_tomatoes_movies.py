"""
dataset generated by this script has (1) same columns (2) same #rows (3) possibly different contents w.r.t.
that appeared in the original paper

curl -L -o raw_rotten_tomatoes.zip https://www.kaggle.com/api/v1/datasets/download/stefanoleone992/rotten-tomatoes-movies-and-critic-reviews-dataset
unzip raw_rotten_tomatoes.zip

after join:
    rotten_tomatoes_link                1129887
    critic_name                         1111366
    top_critic                          1129887
    publisher_name                      1129887
    review_type                         1129887
    review_score                         823985
    review_date                         1129887
    review_content                      1064109
    movie_title                         1129887
    movie_info                          1120202
    critics_consensus                    991907
    content_rating                      1129887
    genres                              1129642
    directors                           1115423
    authors                             1075164
    actors                              1119492
    original_release_date               1106787
    streaming_release_date              1119728
    runtime                             1121623
    production_company                  1118061
    tomatometer_status                  1128421
    tomatometer_rating                  1128421
    tomatometer_count                   1128421
    audience_status                     1093166
    audience_rating                     1125598
    audience_count                      1125230
    tomatometer_top_critics_count       1129887
    tomatometer_fresh_critics_count     1129887
    tomatometer_rotten_critics_count    1129887
"""
import pandas as pd

review_df = pd.read_csv("rotten_tomatoes_critic_reviews.csv")
movie_df = pd.read_csv("rotten_tomatoes_movies.csv")
df = review_df.merge(movie_df, on="rotten_tomatoes_link")
print(df.count())

required_columns = ["rotten_tomatoes_link", "review_type", "review_content", "top_critic", "movie_info"]
sampled_df = df.sample(n=15018, random_state=0)[required_columns]
output_file_path = "Rotten_Tomatoes_Movie_Reviews.csv"
sampled_df.to_csv(output_file_path)
